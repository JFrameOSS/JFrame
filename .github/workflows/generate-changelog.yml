name: Generate Changelog

on:
  workflow_dispatch:
    inputs:
      from_tag:
        description: 'From Tag (leave empty to auto-detect)'
        required: false
        type: string
      to_tag:
        description: 'To Tag (leave empty to auto-detect)'
        required: false
        type: string

permissions:
  contents: read
  pull-requests: read

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Generate Changelog
        id: changelog
        uses: mikepenz/release-changelog-builder-action@v4
        with:
          configuration: ".github/changelog-configuration.json"
          commitMode: true
          fromTag: ${{ inputs.from_tag }}
          toTag: ${{ inputs.to_tag }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Output Changelog
        run: |
          echo "================ CHANGELOG ================"
          echo "${{ steps.changelog.outputs.changelog }}"
          echo "==========================================="
